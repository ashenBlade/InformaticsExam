# Вопросы по сетям

## Datacom

###  Data Communication Network Basis

Broadcast domain - все узлы в одном domain получают сообщение, отправленное одним.

Узлы коммункации:
- Switches, Коммутаторы
  - L2
  - Близкая коммуникация (ПК рядом)
  - Broadcast domain
- Routers, Маршрутизаторы
  - L3
  - Перенаправление пакетов, обнаружение путей, WAN, NAT, безопасность
  - Изоляция Broadcast domain
- Firewalls, Файрвол
  - Безопасность
  - Проверка уровня доступа
  - Управление коммункцией между сетями
  - VPN
  - Шифрование
- Wireless, Беспроводные
  - WLAN
  - Радиоволны, лазер, инфракрасные сигналы
  - IEEE 802.11 (Wi-Fi)
  - AP - Access Point (Fat, Fit)
  - AC - Access Controller

Типы сетей:
- LAN:
  - Несколько км^2
  - Подключение нескольких ПК 
  - Ethernet, Wi-Fi
- MAN:
  - LAN, но больше
  - Подключение баз данных, серверов, других LAN
  - Ethernet (10-100 Gbit/s), WiMAX
- WAN

Типы топологий:
- Star, Звезда - все подключены к центральному
- Bus, Общая шина - все со всеми через 1 кабель
- Ring, Кольцо - каждый с передним и задним (образуют кольцо)

Топологии могут быть физическими и логическими. 
Причем физ. и логич. не обязательно одинаковы.

#### Вопросы
1. A star network is robust and therefore not prone to faults. ***false***

2. A router can break broadcast domains ***true***

3. What is the disadvantage of a tree network? 

- ***Nodes at higher layers will cause more serious network problems if they become faulty.***

4. Which functions does a firewall provide?
- ***Isolates networks of different security levels.*** 
- ***Uses security policies to implement access control between networks of different security levels.***
- ***Implements remote access.***
- ***Implements data encryption and virtual private network services.***
- ***Implements network address translation.***

###  Network Reference Model

OSI - Open System Interconnection.
ISO 7489 standard. Выпущен в 1984.
Состоит из 7 слоев:
1. Физический, Physical:
- Передача потока битов между устройствами
- Требования к физическому каналу: напряжение, скорость, разъем...
2. Канальный, Data:
- Определяет физические адреса 
- Инкапсуляция битов во октеты (8 шт), а октеты во фреймы
- Перенос данных в 1 сети 
- Использует MAC адреса (XX-XX-XX-XX-XX-XX)
- Проверка ошибок
3. Сетевой, Network
- Определяет логические адреса
- Нахождение путей для передачи данных
4. Транспортный уровень
- Connection/Non connection oriented data transmission
- Передача данных
- Проверка ошибок
5. Сессионный, Session
- Создание, поддержание, прекращение сессии
- Работает для уровня представления
6. Представления, Presentation
- Кодирование/Декодирование данных отправляемых приложением
7. Прикладной, Application
- Само приложение, логика

PDU - packet data unit, единица передачи данных (frame, bit, packet)

TCP/IP:
1. Канальный, Data Link: Ethernet, PPP:
- PDU - фрейм
- Ethernet, PPP, PPPoE
2. Сетевой, Network: 
- PDU - пакет
- IPv4, IPv6, ICMP, IGMP
3. Транспортный, Transport: 
- PDU - сегмент 
- TCP, UDP
4. Прикладной, Application: 
- HTTP
- FTP (передача файлов)
- Telnet (удаленный доступ)

Организации стандартизации:
- IETF, Internet Engineering Task Force
- IEEE, Institute of Electrical and Electronics Engineers
- ISO, International Organization for Standardization

TCP:
- PDU = segment
- Пакет
  1. Source port(откуда), 16
  2. Destination port(куда), 16
  3. Sequence number(какой пакет передаю), 32
  4. Acknowledgment number(какой пакет собираюсь принять = последний успешно полученный + 1), 32
  5. Header length(размер TCP заголовка, если дополнительного ничего нет, то = 5), 32
  6. Reserved(для будущего), 32
  7. Control bits(флаги для FIN, ACK, SYN)
  8. Window (размер передаваемого окна), 16
  9. Checksum(для проверки, обязателен), 16
- TCP handshake
  1. A посылает B пакет с флагом SYN (sequence number - a (рандомный), acknowledgement - 0)
  2. B отвечает A пакет с флагом SYN + ACK (sequence number - b (рандомный), acknowledgement - a + 1)
  3. А посылает B пает с флагом ACK (sequence number - a + 1, acknowledgement number - b + 1)
  4. Соединение установлено
- Sliding window
  - Отправка сообщений целым окном (буффером)
  - Если какое-то сообщение не дошло, то новое окно отправляется, начиная с первого недошедшего
- TCP shutdown
  1. A посылает B пакет с FIN
  2. B отвечает A с флагом ACK
  3. B проверяет на необходимость дослать данные
     1. Если есть - шлет данные, затем пакет с FIN
     2. Если нет - сразу пакет с FIN
  4. A посылает B пакет с ACK
  5. Соединение закрыто

MAC:
- 6 групп из 2 раделенных 16-ых чисел (0-F)
- XX-XX-XX-XX-XX-XX
- Работает на канальном уровне

ARP, Address Resolution Protocol:
- Нахождение MAC данного IP адреса
- Поддержка, кэширование найденных адресов (ARP entries)
- Нахождение дупликатов IP в сегменте
- Алгоритм:
  1. Проверка ARP кэша:
     - Запись существует
     - Не истек срок валидности
     - Если из другой сети - адрес шлюза (gateway)
  2. Посылка ARP Request:
     - В Ethernet заголовке - Destination MAC = FF-FF-FF-FF-FF-FF
     - В ARP Request заголовке - Destination MAC = 00-00-00-00-00-00
     - ARP Request message = Source MAC, Source IP, Destination MAC, Destination IP
     - Broadcast
  3. Получение хостами ARP Request:
     - Обновление своих ARP entries
  4. Посылка ARP Reply:
     - IP, MAC отправителя - свои (которые нужно было узнать)
     - IP, MAC получателя - кто запрашивал
     - Unicast 
  5. Обновление ARP entry

Физический уровень:
- PDU: bitstream, поток битов
- Нужно стандартизировать физические особенности: напряжение, кабель, входы
- Передача:
  - Витая пара:
    - STP: shielded twisted pair
    - UTP: unshielded twisted pair
  - Оптоволокно
  - Последовательный кабель (для WAN)
  - Беспроводная передача (радио-канал)

Процесс коммуникации:
1. Отправитель передает данные нижележащему уровню (Application -> Transport -> Network ...)
2. Каждый слой добавляет информацию о своем уровне 
3. Доходим до физического слоя - производим саму передачу 
4. Получатель развертывает сообщение по слоям в соответствии с использованными протоколами (Data Link -> Network -> Transport ...)

В общем случае:
- Switch - передача в текущей сети, используя заголовок L2
- Router - передача между сетями, используя заголовок L3

###  Huawei VRP

VRP - ОС для устройств Huawei:
- UI + управление
- Control Plane + Forwarding Plane
- Коммуникация между другими устройствами

Файловая система: 
- Файл конфигурации (Команды при запуске)
- PAF файл (Поддержка фичей конкретного устройства)
- Патч файл
- Системные файлы

Хранение доп. информации:
- SD Card (конфигурация, системные файлы)
- USB (для увеличения объема памяти)
- SDRAM ~ память ПК
- Flash (конфигурация, системные файлы)
- NVRAM - Non Volatile (не изменяемая)

Управление устройством + подключение:
- Веб интерфейс (HTTP)
- CLI (SSH, Telnet, Console port)

VRP UI:
- Console UI - через порт консоли/последовательный
- VTY UI - через SSH(STelnet)/Telnet

Уровни привилегий:
- 0 - Visit (диагностика сети (ping, tracert) + некоторые display)
- 1 - Monitoring (display)
- 2 - Configuration
- 3-15 - Management (системные операции, дебаг, FTP...)

Команды:
- Все организовано в виде *-view:
  - system-view
  - user-view
  - когда вводишь interface GigabitEthernet 0/0/0 - входишь в GigabitEthernet-0/0/0-view
  - Каждый view - поддерживает свои команды и свой контекст
- Командная строка:
  - Tab - autocomplete
  - ? - команды начинающиеся на предыдущий ввод
  - Есть шорткаты: Ctrl+U, Ctrl+A, Ctrl+C, Ctrl+X....
  - Можно зарегистрировать свои шорткаты: Ctrl+L
- Откат команды - undo + "команда для отката"

Базовые команды:
- pwd - текущий путь
- dir - файлы в текущей папке
- more - содержимое файла
- cd - перейти по пути
- mkdir - создать папку
- ....

Первоначальная настройка:
- Дать название устройству - `sysname *Name*`
- Настроить часовой пояс - `clock timezone *Timezone*`
- Настроить время/дату - `clock datetime *date/time*`
- Уровень привилегий - `command-priviledge level *level* view *для какого view*`
- Логин/Пароль для пользователей - `user-interace vty 0 4`
- Время простоя - `idle-timeout *timeout*`

Сохранение настроек:
1. Входим в User-View (`return`)
2. `save`

###  Network Layer Protocols and IP Addressing

IP - Internet Protocol.

IPv4:
- Заголовок:
  1. Версия
     - 4 bits
     - Значение = 4
  2. Длина, Header Length
     - 4 bits
  3. Тип сервиса, Type Of Service
     - 8 bits
     - Работает при включенном QoS
  4. Общая длина (включая заголовок), Total Length
     - 16 bits
     - В октетах
     - Минимальное - 20
     - Максимальное - 65535
  5. Идентификатор, Identification
     - 16 bits
     - Назначается отправителем для корректного восстановления пакета
  6. Флаги, Flags
     - 3 bits
     - [0] всегда равен 0 (зарезирвирован)
     - [1] DF (Don't fragment) - запрет на фрагментацию
     - [2] MF (More fragments) - есть ли еще пакеты
  7. Offset:
     - 12 bits
     - При разбиении пакета
     - Относительная позиция в исходном пакете (который разбили, а не передают)
  8. TTL
     - 8 bits
     - Время жизни - макс. кол-во хопов (роутеров), которое может пройти
     - Если пришел с 0, то отбрасывать + послать ICMP error, иначе - декрементировать и передать
  9. Протокол, Protocol
     - 8 bits
     - Какой протокол инксапсулирует (TCP(6), UDP(17), ICMP(1)...)
  10. Header checksum
      - 16 bits
  11. SourceIP
      - 32 bits
  12. DestinationIP
      - 32 bits
  13. Options:
      - 1 - 32 bits
      - Необязателен
      - Макс. - 10 параметров
  14. Padding:
      - Занимает оставшееся место для выравнивания строки с параметром по 32 bits
  15. Сами данные
- Сам загловок (без данных) имеет размеры:
  - Фиксированный - 20 байт
  - С параметрами - 20 + (0 - 40 байт)
- Адрес:
  - 32 bits
  - 4 байта разделенные точками
  - 0.0.0.0 - 255.255.255.255
  - Разделяется на сетевую и хостовую части. Сетевая - адрес сети, Хостовая - адрес хоста (компа).
  - Для определения сети/хоста используется маска - 32 бита, сначала 1 затем 0, обычно представляется в виде числа - кол-ва единиц в маске
- Классификация
  - Различия в количестве единиц перед первым 0 в адресе (most significant bits)
  - Class A
    - 0.0.0.0 - 127.255.255.255
    - 0NNNNNNN.X.X.X
    - /8
  - Class B
    - 128.0.0.0 - 192.255.255.255
    - 10NNNNNN.X.X.X
    - /16
  - Class C
    - 192.0.0.0 - 223.255.255.255
    - 110NNNNN.X.X.X
    - /24
  - Class D
    - 224.0.0.0 - 239.255.255.255
    - 1110NNNN.X.X.X
    - Для мультикаста
  - Class E
    - 240.0.0.0 - 255.255.255.255
    - 1111NNNN.X.X.X
    - Зарезирвировано, для исследований
- Типы адресов
  - Адрес сети
    - Адрес сети X, адрес хоста - 0
    - Не может быть отдан хосту
  - Broadcast
    - Адрес сети X, адрес хоста - 1
    - Не может быть отдан хосту
  - "Доступный" адрес
    - Может быть отдан хосту
    - Все кроме выше перечисленных (в кратце все, у которых адрес хоста не все 0 или 1)
    - Кол-во доступных = 2^n - 1, n - длина хостовой части в битах (32 - длина маски)
  - Публичный, Белый IP
    - Назначается IANA (для каждого географического региона есть свой представитель)
  - Приватный, Частный, Серый IP
    - Для тех, что не выходят в Интернет (для обхода использовать NAT)
    - 10.0.0.0 - 10.255.255.255
    - 172.16.0.0 - 172.31.255.255
    - 192.168.0.0 - 192.168.255.255
  - Особые
    - Limited broadcast:
      - 255.255.255.255
      - Для всех в текущей сети (не выходят за границы шлюзов)
    - Any IP
      - 0.0.0.0
      - Для разных контекстов - разные значения (путь по умолчанию, текущий все адреса на локальном компьютере)
    - Loopback
      - 127.0.0.0/8
      - Прослушивается на текущем ПК
    - Link-local
      - 169.254.0.0/24
      - Если не выделяется адрес при помощи DHCP, клиент выделяет себе адрес сам из этой сети (рандомом)
      - 

Subnetting - объединяем хосты в группы под определенной маской.
Для объединения нескольких сетей в одну:
1. Получаем маски всех сетей
2. Находим самую длинную
3. Вычитаем 1 (чтобы не было коллизий)
4. Объединяем сети под этой новой маской (сами разберутся куда отсылать дальше)


ICMP - Internet Control Message Protocol. Для управления, получения статуса в сети.
Некоторые функции:
- Редирект. Перенаправление.
Например, отправляю пакет на default gateway, он понимает, что пакет нужно отправть на другой шлюз и шлет мне ICMP Redirect.
- Обнаружение ошибок. Например, кончился TTL (используется в ping).
- Отчет об ошибках
  - Циклы в сети
  - Destination unreachable

Команда для настройки адреса: `ip address *ip-address* *mask*`

###  IP Routing Basics

Для адресации к конкретному хосту в конкретной сети используются IP адреса.
Каждому устройству назначается свой собственный адрес.

Устройства, использующиеся при коммуникации:
- Узел, Хост - тот, кому назначается сообщение, конечный получатель
- Шлюз, Gateway - устройство для коммуникации между сетями (портал в другое измерение)
- Маршрутизатор - устройство для построения маршрутов IP сообщений
  - Может быть и шлюзом, и узлом, и конечным устройством

Для определения пути сообщения используется таблица маршрутизации.
Записи в ней должны содержать (обязательно):
- Destination - куда предназначается
- Mask - определение сети/хоста получателя (без них не понятно)
- Next hop - по какому следующему адресу сообщение посылать (IP)
- Outbound interface - на какой физический интерфейс подавать сообщение (Wi-Fi, Gigabit Ethernet...)

Таблица может содержать дополнительно:
- Protocol - откуда получен путь
- Pre(ference) - число, показывающее предпочтительность пути. Чем меньше, тем лучше.
- Cost - стоимость пути, метрика. Если в одну и ту же точку ведут несколько одинаковых по Pre путей, то используется Cost. Чем меньше, тем лучше.

AS (Autonomous system) - автономная система.
Группа взаимосвязанных хостов, роутеров, образующих единую систему.

Путь может проходить несколькими способами:
- Direct, Прямой 
  - Соединяет хост напрямую в той же сети, что и роутер
  - Соединяет другую подсеть напрямую - не транзитивно
  - Определяется автоматически
  - Использует ARP для нахождения MAC адреса
  - Default Pre - 0
- Static, Статический
  - Настраивается администратором вручную
  - Default Pre - 60
  - `ip route-static *ip-address* *mask* *next-hop*`
  - Указание шлюза по умолчанию - `ip route-static 0.0.0.0 *default-gateway-ip-address*`
  - Типичное использование - выходной шлюз из корпоративной сети(выход в интернет, в другие корпоративные сети, выход на VPN)
- Dynamic, Динамический 
  - Пути обнаруживается с помощью протоколов (OSPF, IS-IS, BGP)
  - По алгоритмам:
    - Distance-vector (RIP)
    - Link-state (OSPF, IS-IS)
  - По области применения:
    - IGP (Interior Gateway Protocol) - внутри AS
    - EGP (Exterior Gateway Protocol) - между AS
  - OSPF internal default Pre - 10
  - OSPF external default Pre - 150

Возможные граничные случаи:
- Рекурсия
  1. A -> B (1.1.1.1 -> 1.1.1.2)
  2. B -> A (1.1.1.2 - нет, отправляю по Default -> 1.1.1.1)
- Одинаковые по стоимости пути (Equal-Cost)
  - На один и тот же маршрут - разные Next-Hop с одинаковыми стоимостями
  - Распределение трафика между ними - Load Balancing
- Запасные пути, Floating Route
  - Если использующийся оптимальный путь обрубился - использовать запасной

CIDR (Classless Inter-Domain Routing) - безклассовая маршрутизация:
- ~ Route Aggregation, Route Summarization
- Замена классовой адресации (A, B, C, D, E)
- Использует маски переменной длины (VLSM - variable length subnet mask)
- Зачем хранить информацию для различных сетей, если они все идут через один и тот же путь 
- Разделение адресного пространства используя суммаризацию (объединение масок из различных сетей) 
  1. Находим адреса с одинаковыми NextHop
  2. Среди них выбираем те, у которых есть общая часть в адресе сети
  3. Берем маску длиной в эту общую часть
  4. Объединяем сети - всем адресам ставим новую, найденную маску
- 192.168.12.0/22 + 192.168.10.0/23 + 192.168.9.0/21 + 192.168.14/0/23 = 192.168.8.0/21
- В результате: минимизация таблицы маршрутизации
- Может возникнуть цикл (для предотвращения - отбрасывание пакетов, приводящих к циклам)

###  OSPF Basics

Алгоритмы маршрутизации:
- Distance-vector
  - Передача возможных путей передачи
  - Без информации о топологии сети
- Link-state
  - Передача LSA (Link-State Advertisement) - информации о каждой напрямую присоединенной сети (название, стоимость...)
  - Каждый строит у себя топологию всей сети
    
OSPF - Open Shortest Path First:
- RFC 2328
- Использует SPF - shortest path first алгоритм 
- Поддерживает маски переменной длины
- Существует несколько версий (OSPFv2, OSPFv3) 

Типы сообщений:
- Hello - обнаружение соседей, проверка параметров, мониторинг доступности...
- LSA (Link state advertisement) - сообщение с инфорацией о своей + присоединенных сетях (офиц. Объявление о состоянии канала). Существует несколько типов.
- LSR (Link state request) - запрос определенных записей о состоянии канала (для синхронизации)
- LSU (Link state update) - обновление записей о состоянии канала (ответ на LSR)
- LSAck (Link state Acknowledgement) - подтверждение получения пакета
- DBD (Database Description) - описание базы данных топологии

LSDB (Link state database) - база данных с информацией о топологии:
- Type - тип LSA, который добавил информацию
- LinkStateID
- AdvRouter - кто отправил LSA
- Age
- Len
- Sequence
- Metric

OSPF Routing Table - таблица маршрутизации только для OSPF

Типы маршрутизаторов:
- DR - Designated Router - чтобы избежать заводнения LSA
  - Устанавливают связь с другими роутерами
  - Если параметр роутера = 0, то никогда не станет DR
  - Выбор: (DR Priority, Router ID) - первый после сортировки во убыванию
(самый большой DR Priority, затем самый большой Router ID)
- BDR (Backup Designated Router) - если DR вышел из строя
  - Когда он заменяет DR, проводятся выборы нового BDR
- DRother, Internal - простой роутер
  - Между собой связь не устанавливают
- ABR, Area Border Router - принадлежит к нескольким Area, но как минимум один - к Backbone
- Backbone router - присоединяет Backbone area
- ASBR, AS Boundary Router - общается с другими AS. Напрямую присоединять внешние AS - нельзя.

Концепции OSPF:
- Area - логическая группа, определяемая своим IP. Всегда существует Backbone Area - 0.0.0.0. Если Area - одна, то 
  - Кол-во DRothers сильно увеличивается. Чтобы избежать нужно разбивать на отдельные Area
  - Роутер должен строить топологию для всей сети, а она будет большой. Нужно дробить.
  - Производительность DR - падает из-за большого кол-ва DRothers
  - Типы Area:
    - Backbone, Магистральная - 0.0.0.0, ядро сети, должна быть всегда
    - Standard, Стандартная - обычная зона
    - Stub, Тупиковая - не принимает информацию о внешних сетях (не выходит в свет/интернет/мир)
    - Totally stubby - не принимает информацию о внешних сетях И маршруты других зон (Прям тупик, говорят только с одной зоной и туда все посылают)
    - Not-so-stubby (NSSA) - ~ Stub, но может быть ASBR
    - Totally NSSA - ~NSSA, но не передает информацию о других зонах
- Domain - сеть, состоящая из нескольких соединенных OSPF сетей
- RouterID - идентификация роутера в своей Area. Настраивается вручную
- Cost Value - метрика для выбора пути. По умолчанию, 100 Mbit/s / Bandwidth

Алгоритм OSPF(самый простой, без DR/BDR и прочего):
1. Обменяться HELLO пакетами друг с другом
2. Установить соседство - добавить каждого в свою таблицу соседей
3. Сформировать свой LSA пакет:
   - Свой Router ID
   - Соседские Router ID
   - Сеть
   - Префикс сети
   - Тип сети (P2P, MA...)
   - Метрика (стоимость линка)
4. Флудингом (лавинно) отправить LSA другим соседям
5. Обновить свою LSDB пришедшими LSA
6. Построить топологию сети с помощью составленной LSDB
7. Найти кратчайшие пути до всех других роутеров

При потере соединения с каким-нибудь роутером:
1. Обнаруживший потерю - начать флудить LSA с сообщением о потере
2. Сброс своей LSDB
3. Начать построение сети заново (алгоритм выше)

Замечания:
- OSPF напрямую инкапсулируется в IP (не TCP, UDP)
- Для каждого типа сетей  (Broadcast, P2P, NBMA...) - свои заморочки. Мы проходили только NBMA - Non-Broadcast Multiple Access. Рассказанное относится для сетей Broadcast (Ethernet, Wi-Fi)

Таймеры:
- HelloInternal, Рассылка пакетов HELLO (я живой!) - 10с
- Dead-Time, RouterDeadInterval, Ожидание пакетов HELLO, не менее 4 интервалов рассылки (Hello-Internal) (они живые?) - 40с
- Wait Timer - по его истичении выбирается новый DR - 40с
- Retransmit-Interval, RxmtInterval, Повторная передача LSA (при неудачи посылки LSA, время между отправками) - 5с, макс 60мин
- Transmit-Delay, Время передачи LSA (время корректности записи = время содержания записи в таблице + время передачи(Transmit-Delay)) - 1с (для всех каналов)

###  Ethernet Switching Basics

Ethernet - протокол L1 и L2. 

Collision Domain (Домен коллизий) - множество соединенных узлов с одним пространством распространения сообщений (крч, отправляют сообщения по одному кабелю).
Просто - если один шлет, то все другие принимают, а если несколько шлет - то сообщения "бьются" друг о друга и ломаются.

CSMA/CD (Carrier Sense Multiple Access with Collision Detection) - коллизии только обнаруживаются, а не исправляются:
1. Постоянно прослушиваю канал. Слушаю несущую частоту.
   1. Если линия свободна - шлю сообщения
   2. Иначе жду освобождения
2. Обнаружилась коллизия:
   1. Оба устройства прекращают слать данные
   2. Кто-то шлет jam последовательность - сигнал о том, что произошла коллизия
   3. Ждем какой-то (случайный) период времени
   4. Начинаем слать заново

Вкратце: слушаем перед/во время передачи, при коллизии - стоп и ждем рандомное время

Broadcast domain - область, в которой все получают Broadcast сообщения по L2.
Нужно слать Ethernet фреймы с MAC = FF-FF-FF-FF-FF-FF.
Можно образовать:
- Подсоединяя все узлы одним кабелем
- Соединяя хосты через хабы, концентраторы, повторители

NIC (Network Interface Card) - устройство принимающее/посылающее Ethernet кадры

Кадры:
- Существует в 2 версиях - Ethernet_II и IEEE 802.3. В IEEE добавлены поля LLC и SNAP
- Ethernet_II:
1. Destination MAC, 6B - кому
2. Source MAC, 6B - от кого
3. Type, 2B - какой протокол (0x0800 - IPv4, 0x0806 - ARP)
4. User Data, 36-1500B
5. Frame Check Sum (FCS), 4B
- IEEE 802.3:
1. Destination MAC, 6B - кому
2. Source MAC, 6B - от кого
3. Length, 2B - длина заголовка
4. LLC, Logical Link Control:
   1. DSAP, Destination Service Access Point, 1B - ~ кому предназначается. Если инзлежащий - IP, то 0x06.
   2. SSAP, Source Service Access Point, 1B - откуда. Если низлежащий - IP, то 0x06.
   3. Ctrl, 1B - обычно 0x03.
5. SNAP, Subnetwork Access Protocol, 2B - если DSAP, SSAP - 0xAA
   1. OUI, 3B
   2. Protocol ID, 2B
6. User Data, 36-1500B
7. Frame Check Sum (FCS), 4B

MAC, Media Access Control - для идентификации NIC:
- 6 байтов
- XX-XX-XX-XX-XX-XX
- Первые 3 байта - OUI, Organization Unique Identifier, ID производителя
- Вторые 3 байта - CID, Company ID, назначается производителем

Типы MAC:
- Unicast - идентификация узла, глобально уникален:
  - Ethernet frame, у которого уникальный MAC называется уникальным  
- Broadcast - всем узлам в сети (на L2 уровне) - FF-FF-FF-FF-FF-FF
  - Ethernet frame, у которого broadcast MAC называется multicast
  - Для групповой рассылки

Коммутаторы:
- Уровни работы:
  - L2:
    - Только Ethernet frame
    - Организуют Broadcast domain
    - Изолируют Collision domain
  - L3:
    - Может читать IP заголовок (всм, заговок 3 уровня)
- Для коммутации используются таблицы коммутации:
  - MAC адрес назначения
  - Интерфейс/порт куда отправлять (физический, GigabitEthernet0/0/0...)
- Заполнение таблицы - Обратное обучение:
0. Таблица не заполнена. Ни о ком не знаю
1. Получаю Ethernet frame.
2. Добавляю адрес отправителя в таблицу коммутации
3. Адрес получателя есть в таблице?:
   - Нет:
     1. Отправляю на все порты фрейм с требуемым MAC (получают все, кроме отправителя)
     2. Обладатель требуемого MAC отправляет на коммутатор Ethernet frame со своими данными
     3. Запись данных в таблицу коммутации
4. Отправить данные на требуемый адрес


Состояния порта коммутатора:
- Flooding - отправка всем (не знаю кто получатель, запишу его адрес потом)
  - Если получаю неизвестный MAC
  - Если получаю Broadcast MAC (FF-FF-FF-FF-FF-FF)
- Forwarding - отправка конкретному получателю (запись о нем есть)
- Discarding - пошел нахуй!! (отбрасываю полученные кадры)
  - Если полученный MAC - unicast и по таблице коммутации перенаправляется на другой коммутатор
  - Т.к. может случиться цикл - появляется запись в получающем коммутаторе, и когда в следующий раз фрейм придет к нему, то перенаправит обратно, а тот еще раз и так далее....
  
Процесс коммуникации:
0. Скорее всего я использую ARP кэш для хранения пары IP - MAC. Вначале он пуст.
1. Отправляю ARP запрос (В самом пакете MAC - Broadcast)
2. В процессе отправки/получения ответа заполняются необходимые таблицы коммутации
3. Я получил ответ. Узнал требуемый MAC адрес получателя.
4. Отправляю сами данные - настоящий Ethernet frame с только что узнанным MAC адресом получателя

###  VLAN Principles and Configuration

Проблемы Ethernet:
- Создает Broadcast domain:
  - В нашей сети все получат фрейм - даже те кому он нах*й не нужон!
- Безопасность:
  - Все могут прочитать отправляемые данные: если неизвестен, то отправляется всем + сами коммутаторы получают

VLAN, Virtual LAN - технология создания виртуальных (изолированных локальных сетей, там только MAC - не IP).
IEEE 802.1Q - добавляет поле VLAN Tag (4 байта) в Ethernet Frame. 
Можем разделить большие сети на несколько меньших:
- Данные получают только те кому они реально могут предназначаться
- Уменьшение загруженности трафика
- Если одна сеть упадет - не затронет другие

Реализация:
- С каждым портом коммутатора (присоединенного к конечному хосту) ассоциирован VLAN, к которому он закреплен.
- При получении кадра с этого порта, к его Ethernet frame добавляется VLAN Tag и работа продолжается. 
- VLAN Tag добавляется после Source MAC, перед Length/Type:
  - TPID, 2 байта - тип кадра, для совместимости с другими версиями (0x0800 - обычный Ethernet frame), здесь равен 0x8100 - IEEE 802.1Q
  - Pri(ority), 3 бита - приоритет кадра, для QoS
  - CFI, Canonical Format Indicator, 1 бит:
    - 0 - канонический кадр
    - 1 - не канонический кадр (FDDI, Token Ring)
  - VLAN ID, 12 бит - к какому VLAN относится

Компьютеры шлют кадры без VLAN тэгов. 
Их назначением занимается коммутатор.
Варианты назначения VLAN ID:
- По порту получателю.
  - PVID - Port VLAN ID. От его лица (его значение в VLAN ID) будут отправляться нетегированные фреймы
  - Настроить PVID на каждом физическом порте коммутатора
  - PVID: 1-4096. По умолчанию - 1
  - По типу интерфейса:
    - Access - к конечному пользователю
      - От клиента:
        - Без тега - тэгируется 
        - Тэгированный - проверяется VID и PVID
      - Клиенту: 
        - Тэгированный - проверяется VID и PVID и возвращается без тега 
    - Trunk - к другому роутеру, коммутатору, AP....
      - От клиента:
        - Без тега - тэгируется
        - Тэгированный - проверяется VID и PVID
      - Клиенту:
        - Тэгированный - убрать VLAN tag если VID = PVID интерфейса
    - Hybrid - и к тем, и к другим может быть подключен
      - От клиента
        - Без тега - тэгируется, затем проверить доступ
        - Тэгированный - проверить VID и PVID
      - Клиенту
        - Без тега - отправить
        - Тэгированный - в зависимости от получателя (убрать или нет)
- По MAC адресу отправителя
  - Заполнить таблицу отображений MAC - VLAN ID на каждом коммутаторе

Команды:
- `vlan *vlan id/batch*` - создание VLAN
- `interface GigabitEthernet 0/0/0` - заходим на требуемый интерфейс
- Access:
  - `port link-type access`
  - `port default vlan *vlan id*` - назначаемый VLAN ID проходящим фреймам
- Trunk:
  - `port link-type trunk`
  - `port trunk pvid vlan *vlan id*` - назначение PVID порту
  - `port trunk allow-pass vlan *ids*` - разрешить доступ VLAN
- Hybrid:
  - `port link-type hybrid`
  - `port hybrid pvid vlad *id*` - назначение PVID
  - `port hybrid untagged vlan *ids*` - какие назначать нетегированным

###  STP Principles and Configuration

STP, Spanning Tree Protocol - протокол остовного/покрывающего дерева.
Работает на L2.
IEEE 802.1D.
Основная задача - избавление от петель в топологии сети при коммуникации путем блокировки соединения.
Используется в Ethernet.

Последствия петель
- Broadcast storm - если куда-то пришел Broadcast MAC, то он отправляется всем, а в цикле он будет путешествовать всегда1
- MAC address flapping - Ethernet фрейм может прийти с разных портов (т. к. круг/цикл) и из-за этого постоянно меняется таблица коммутации

Термины:
- BID, Bridge ID = Приоритет (2 байта) + MAC (6 байт):
  - Приоритет по умолчанию - 32768
  - Должен делиться на 4096
  - 
- RB, Root Bridge
  - Корень построенного дерева
  - Выбирается с наименьшим BID
- Cost - стоимость пути
  - С большей пропускной способностью - меньше стоимость
  - Huawei по умолчанию использует IEEE 802.1t для вычисления (есть таблица)
- RPC, Root Path Cost
  - Стоимость пути до корня = сумма стоимостей
- PID, Port ID = Приоритет (4 бита) + Номер порта (12 бит)
  - Приоритет: 
    - 0-240, должен быть кратен 16
    - По умолчанию - 128 (Huawei)
  - Для установления роли порта
- BPDU, Bridge Protocol Data Unit
  - Configuration BPDU
    - Для построения дерева, выбора RB
    - После построения дерева, шлет только RB
  - TCN BPDU, Topology Changed Notification
    - Шлется к RB, для уведомления об изменении топологии

Роли портов:
- Designated - к другим подключенным сетям (соединяет другие роутеры)
- Root - к RB (соединяет себя с корнем)
- Alternate - заблокирован (не Root или Designated, избыточный)

Алгоритм STP:
1. Роутер включается и назначает себя RB
2. Шлет другим свой BPDU
3. При получении BPDU от других
   1. Сравнивает полученный BID со своим
   2. Если полученный BID - меньше, то он становится RB
4. Выбрать глобальный RB, когда топология больше не меняется
5. Теперь только RB может слать BPDU
6. Выбрать свой Root порт на каждом из роутеров
7. Выбрать Designated порты на основании полученных от RB BPDU
   1. Выбирается порт с наименьшим RPC
   2. При одинаковых - выбрать с наименьшим PID
8. Заблокировать остальные порты (они Alternate)

Состояния портов:
- Disabled - отключен
- Blocking - только слушает BPDU (ничего не шлет и не принимает другого)
- Listening - слушает BPDU
- Learning - слушает служебные фреймы, но не передает их. После изучает MAC адреса
- Forwarding - делает всю работу. Только для Root и Designated

Причины изменения топологии:
- Отказ корня (обычно занимает 50с):
  1. Корень отказал - остальные не получают BPDU
  2. Ждут MaxAge Timer
  3. Начинается выбор нового RB
- Потеря соединения с Root, но есть запасной
  1. Работать начинает Alternate порт, соединенный с RB
  2. Ждем 2 * FowardDelay Timer (30с) пока новый порт обучится
- Потеря соединения с Root
  1. Ждем MaxAge Timer
  2. Выбираем себя RB
  3. Шлем свои BPDU другим
  4. Т.к. в предыдущий раз Root получил высший приоритет, то он останется Root
  5. Новый порт, подключенный к запасному станет Root или Designated
  
STP имеет большое время схождения - 50с (2 * ForwardDelay + MaxAge). 
Чтобы избавиться от этой проблемы был создан RSTP - Rapid STP.
Изменения:
- 3 состояния портов:
  - Discarding
  - Learning
  - Forwarding
- 5 ролей портов:
  - Root
  - Designated
  - Alternate
  - Backup - 
  - Edge - напрямую соединен с клиентом
- Меньше интервал рассылки BPDU
- Изменение формата BPDU


Таймеры:
- MaxAge Timer - 20с, время ожидания BPDU
- ForwardDelay Timer - 15с, таймер перехода в Forwarding State порта

MSTP, Multiple STP - версия STP для нескольких сетей (VLAN)

###  Inter-VLAN Communication

Общение через VLAN может происходить на L2 и L3 уровнях.
Если на L2, то как мы узнаем IP. 
А если на L3, то все будут получать Ethernet кадры.
Чтобы избавиться от этой проблемы нужно соединить эти 2 уровня вместе.

1 способ - только физические интерфейсы:
1. Настраиваем коммутаторы на работу в режиме VLAN
2. Для каждого VLAN отдельный кабель к роутеру
3. Т.к. Роутер не поддерживает VLAN, то перед отправкой - убираем VLAN (делаем обычный Ethernet II кадр) 

2 способ - VLANIF (нужен коммутатор работающий на L3)
1. Настраиваем коммутаторы на работу в режиме VLAN
2. Настраиваем VLANIF интерфейсы:
   1. `interface vlanif *id*` - создать интерфейс
   2. `ip address *ip* *mask*` - указать Gateway для перенаправления

Процесс коммуникации:
1. Клиент отправляет нетэгированные кадры на коммутатор
2. Коммутатор 1 получает кадр:
   1. Смотрит куда напрявлять кадр.
   2. Если в другую сеть, то добавляет VLAN ID
3. Коммутатор 1 направляет кадр коммутатору 2
4. На коммутаторе 2 установлен VLANIF интерфейс:
   1. Направляет кадр на свой интерфейс (Routing module)
   2. Ищет в специальной таблице коммутации путь для дальнейшей пересылки кадра
5. После нахождения адреса, удаляет свой VLAN ID тэг и направляет на другое устройство
6. Через какое-то время приходит ответ и он в обратном порядке возвращается отправителю

В общем, VLANIF - фича коммутаторов для коммуникации между различными VLAN. 
С ее помощью можно обнаруживать IP пакеты (соответственно сами IP адреса кому предназначается) 
внутри Ethernet кадров и перенаправлять эти кадры по своим правилам (на другой интерфейс коммутатора и он сам подменить VLAN Tag), 
чтобы не нагружать роутеры (они про VLAN не знают).
Таким образом, из своей физической L3 сети мы не выходим и 
общаемся через различные VLAN. 

###  Eth-Trunk iStack and CSS

Eth-Trunk - технология аггрегирования Ethernet кабелей (каналов).
Если несколько кабелей подлючены и ведут в одно и то же место, 
то можно их объединить в один логический.
Таким образом, увеличиваем пропускную способность без обновления физического (самих коммутаторов).

Для создания Eth-Trunk интерфейса нужны:
- Несколько (1+) установленных соединений
- Одинаковые:
  - Скорости интерфейсов
  - Конфигурации VLAN (если используется)
- Дуплексный режим

Режимы:
- Ручной:
  - Все создается и настраивается вручную
  - Нет автоматического отслеживания неполадок 
- LACP:
  - Использует LACP - Link Aggregation Control Protocol (название протокола такое же)
  - Устройства обмениваются LACPDU (LACP Data Unit) для управления состоянием
  - LACPDU = приоритет устройства + MAC + приоритет интерфейса + номер интерфейса
  - Можно настроить макс. кол-во активных интерфейсов (другие - резервные)
  - Алгоритм:
  1. Выбирается главный - наименьший приоритет устройства
  2. Выбираются активные интерфейсы. Меньшее значение приоритета. Если одинаковые - меньший номер интерфейса.
- Балансировка нагрузки
  - На основании MAC или IP (и в ту, и в другую, и в обе стороны одновременно)
  - 

iStack, Intelligent Stack - несколько физических коммутаторов объединяются в один логический.
Соединяются через специальный кабель. 
Используют одни и те же правила. 
Действуют как один организм.

CSS, Cluster Switch System - несколько физических коммутаторов соединяются друг с другом, 
чтобы в случае отказа одного, другой начал работать вместо него. 
Используется CSS канал между ними

Обычно используется связка iStack, CSS, Eth-Trunk:
- Увеличение надежности сети (есть замена, CSS)
- Увеличение пропускной способности (аггрегация каналов, Eth-Trunk)
- Увеличение кол-ва клиентов - просто добавить еще один коммутатор в специальный разъем (iStack)
- Не требуется MSTP (для коммутаторов использующих CSS)

###  ACL Principles and Configuration

ACL, Access Control List - технология, использующаяся для настройки правил маршрутизации.
По сути, это просто последовательный список правил - 
поступивший запрос проходит по нему шаг за шагом пока не наткнется на условие касающееся его и выполняет, что там написано.
В общем случае - для любого правила ACL есть только 2 исхода - permit или deny.
Может применяться как к входящему, так и исходящему трафику.
Варианты применения:
- Фильтрация трафика
- NAT
- Политика маршрутизации
- Файрвол
- QoS

Задание правила:
1. `acl number *acl-number*` - создание списка правил (ACL)
2. `rule *rule-number* {deny|permit} *rest*` - добавление правила
3. `traffic-filter {inbound|outbound} acl *acl-number*` - фильтрация трафика на интерфейсе

Каждое правило имеет свой ID - номер в списке
(можно вставить правило между другими существующими). 
По умолчанию, добавляется в конец с номером +5 от последнего.

Варианты ACL:
1. Базовый
   - 2000-2999
   - IPv4, источник и назначение, временные диапазоны
2. Расширенный
   - 3000-3999
   - То, что в Базовом + типы IPv4, типы ICMP, номера портов TCP/UDP

###  AAA Principles and Configuration

AAA - Authentication, Authorization, Accounting - механизм сетевой безопасности.
Архитектура сети с AAA:
- User - сами пользователи. Подключаются к NAS
- NAS, Network Access Server - сетевой сервер доступа: управление (перенаправление) пользователями в зависимости от их области (домена). 
Каждый домен может иметь свой собственный AAA.
- AAA Server - сам сервер занимающийся AAA

Имя пользователя: username@domain, username - имя пользователя, domain - домен, в котором зарегистирован.
Если домен не указан, то используется по умолчанию.

Режимы аутентификации:
- Non-authentication
  - Пользователи доверенные
  - Ничего не проверять
- Local authentication
  - На сервере NAS хранятся данные о пользователе
  - NAS используется как (вместо) AAA сервер
  - Ограничение памятью устройства
  - Часто используется в связке с Telnet, FTP
- Remote authentication
  - На сервере AAA хранятся данные о пользователе
  - Могут использоваться RADIUS или HWTACACS. В таком случае, NAS используется как клиент к этим серверам.

Режимы авторизации:
- Non-authorization
  - Без ограничений
- Local authorization
  - Авторизация на основе правил указанных при конфигурации NAS
- Remote authorization
  - HWTACACS - все пользователи авторизуются HWTACACS сервером
  - RADIUS - только к аутентифицорованным этим RADIUS сервером пользователей. 
RADIUS авторизация не может быть многоразовой - говори, что будешь делать сразу.

Режимы учета (accounting):
- Non-accounting
  - Свободный доступ без логов
- Remote accounting
  - Логирование происходит на стороне AAA сервера

RADIUS:
- Часто используется как протокол в AAA
- NAS - клиент RADIUS сервера и действует только на основании ответа от RADIUS сервера
- Работает по схеме клиент/сервер
- Порты UDP:
  - 1812 - Аутентификация
  - 1813 - Авторизация
- Процесс работы:
1. Клиент аутентифицируется на RADIUS сервере, используя свои username/password, через NAS
2. При необходимости доступа отправляет запрос на RADIUS сервер (со своими username/password)
- Типичное использование
  - Проверка доступа в Интернет + учет их аутивности (история, утилизация...)
  - Локальный auth* привилигированных пользователей

Настройка:
1. `aaa` - входим в AAA View
2. `authentication-scheme *scheme*` выбираем схему аутентификации. Автоматический переход в собственный View
3. `authentication-mode {hwtacacs|local|radius}` - выбираем режим аутентификации
4. `domain *name*` - создаем домен с именем. Входим в свой Domain View
5. `authentication-scheme *scheme-name*` - привязываем схему к домену
6. `local-user *username* password {cipher|plain} *password*` - создаем пользователя с паролем
7. `local-user *username* service-type { {terminal|telnet|snmp} | ppp | none }` - настраиваем как пользователь будет подключаться
8. `local-user *username* privilege level *level*` - устанавливаем уровень доступа 

###  Network Address Translation

NAT, Network Address Translation - технология отображения (+ проверки досутупа) адресов

Типы NAT:
- Static NAT
  - Private IP -> Fixed Public IP
  - 192.168.1.1 -> 32.56.9.129 (что видят другие)
  - Для каждого устройства - свой отдельный IP
  - Работает в обе стороны: Интернет -> Сеть + Сеть -> Интернет
  - Настройка
    - `nat static global *ip-outside* inside *ip-inside*` - заполнение таблицы
    - `nat static enable`
- Dynamic NAT
  - Private IP -> Public IP (из пула свободных адресов)
  - 192.168.1.1 -> Смотрю свободные Public IP -> 32.56.9.129 (а может выдаться и 32.56.9.130)
  - Назначается временно - в этот период работает как Static NAT
  - Настройка
    - `nat address-group *group-index* *ip-start* *ip-end*` - создаем пул адресов
    - `acl *number* + rule permit source *source-ip* *wildcard*` - настраиваем ACL
    - `nat outbound *acl-number* address-group *group-index* no-pat` - включаем Dynamic NAT с созданным ACL и пулом, no-pat - без трансляции портов (будет дальше)
- NAPT, Network Address and Port Translation
  - Private IP -> Public IP + Port (из пула)
  - 192.168.1.1 -> 32.56.9.129:3242
  - Для одного Public IP может быть выделено несколько внутренних хостов
  - Настройка - такая же как Dynamic NAT, только не указываем no-pat
- Easy IP
  - Private IP -> Public IP + Port (могут выбираться динамически)
  - Возможна трансляция IP адреса и порта транспортного уровня
  - Настройка:
    - `nat outbound *acl-number*` - также как Dynamic NAT, но не нужен пул адресов - нужен только ACL
  
NAT server
- Занимается отображением адресов.
- Внешние клиенты могут обратиться к клиенту внутри локальной сети
- Например, внутри есть веб-сервер с IP 192.168.0.1 и другие могут сделать к нему запрос на 32.56.9.129
- `nat server protocol *protocol* global *ip-outside* inside *ip-inside* *port-inside*`

###  Network Services and Applications

FTP, File Transfer Protocol:
- Проктол обмена файлами
- Client/Server
- TCP, 20/21
- Режимы передачи:
  - ASCII, Для текстовых файлов
  - Binary, Для остальных
- Режимы работы:
  - Active
  1. Клиент с рандомного порта устанавливает соединение на 21 порт Сервера
  2. Сервер устанавливает Control Connection
  3. Клиент выбирает другой случайный порт P
  4. Если необходимо переслать файлы, то сервер шлет их на порт P клиента
  - Passive
  1. Клиент с рандомного порта устанавливает соединение на 21 порт Сервера
  2. Сервер устанавливает Control Connection
  3. Клиент выбирает другой случайный порт P и отправляет серверу комманду PASV
  4. Сервер выбирает случайный порт N и отправляет клиенту Enter PASV
  5. Если необходимо переслать файлы, клиент открывает соединение с P на N

TFTP, Trivial FTP:
- Простая версия FTP
- Для маленьких файлов
- UDP 69
- Нельзя просматривать файлы директории

Telnet:
- Простое подключение и управление сервером/хостом
- TCP 23
- Для подключения - VTY интерфейс (Virtual Terminal Interface)
- Telnet server - тот, к кому подключаются, Telnet client - тот, кто подключается

DHCP, Dynamic Host Configuration Protocol:
- Динамическое выделение IP адресов
- Client/Server
- Алгоритм
1. Clinet: DHCP Discover - найти DHCP сервер, Broadcast
2. Server: DHCP Offer - предложить IP, Broadcast
3. Client: DHCP Request - соглашение на использование предоставленного, Broadcast
4. Server: DHCP Ack - подтверждение, Unicast
- Адреса выдаются на время. Перед их окончанием нужно продливать

DNS, Domain Name System:
- Отображение названий серверов на их реальные IP адреса
- Доменное имя - иерархический формат (разделение .)
- DNS Серверы - иерархический формат (в соответствии с обсуживаемым доменом)
- Разрешение имени:
  - Рекурсивное: Если не найдено - Сервера обращаются друг к другу
  - Итеративное: Если не найдено - Клиент последовательно обращается к другим серверам

NTP, Network Time Protocol:
- Синхронизация времени на устройствах
- UDP, 123

###  WLAN Overview

WLAN, Wireless LAN - беспроводная локальная сеть.
IEEE 802.11 - Wi-Fi.

Устройства:
- AC, Access Controller
  - Логика учета клиентов (аутентификация, авторизация, DHCP...)
- Fit AP
  - Только раздает Wi-Fi
  - Конфигурация - из AC
- Fat AP
  - Вся логика внутри них (AC + Fit AP)

CAPWAP, Control And Provisioning Wireless Access Points:
- Протокол управления и конфигурированием AP
- Создание CAPWAP туннулей
- Типы сообщений:
  - Data - пользовательские данные, UDP 5247
  - Control - управление AP, UDP 5246

Соединение AP и AC
- In-Path - только AC напрямую соединен с сетью, все данные идут через него
- Off-Path - AC используется как источник конфигурации

BSS, Basic Service Set - область, которую покрывает AP

BSSID, BSS Identifier - ID области покрытия AP, обычно MAC

SSID, Service Set Identifier - ID WLAN строкой, user-friendly

VAP, Virtual AP - для создания нескольких AP из одного физического. 
Например, один для клиентов, другой для сотрудников.

ESS, Extended Service Set - объединение нескольких AP.
Большие сети состоят из нескольких отдельных физических BSS.
Чтобы переходя от одного к другому связь не терялась, нужно объединить их в один логический BSS.

Установление CAPWAP туннеля:
1. Обнаружение AC (Broadcast запросы)
2. Создание туннеля
   1. AC получает Join Request
   2. AC аутентифицирует AP

Поддержание туннеля:
1. Data - обмен Keepalive
2. Control - обмен Echo

Безопасность:
- WEP
- WPA/WPA2
- WPA/WPA2 PSK

Вопросы:
1. Two CAPWAP tunnels are established: data tunnel and control tunnel. They are both kept alive using Keepalive messages. 
- *false* - для Control используется Echo
2. Which of the following 802.11 protocols works only on the 5 GHz frequency band?
- *802.11ac* - остальные используют 2.4GHz
3. Which of CAPWAP message types is used by an AC to deliver configuration files to APs?
- *Configuration Update Response* - Image - для данных, а Configuration Update Request - для информирования о доступных обновлениях
4. Which of the following data frames is used by an AP to periodically broadcast its SSID?
- *Beacon*
5. Which of the following modes are used by APs to dynamically discover an AC?
- *DHCP Mode*
- *DNS Mode*
- *Broadcast Mode*
- Остался только *Manually...*, но он вручную, а нужен dynamically

###  WAN Technologies

WAN, Wide Area Network
- Покрывает огромные территории (км^2)
- Состоит из множества LAN

Типы устройств:
- CE, Customer Edge - расположен у пользователя, соединяется только к PE 
- PE, Provider Edge - расположен у поставщика, соединяется к CE и P
- P, Provider - расположен у поставщика, соединяется только к PE (огрожден от мира, с помощью PE)

PPP, Point-to-Point Protocol:
- P2P соединение - только 2 устройства
- PAP (Password Authentication Protocol) + CHAP (Challenge Handshake Authentication Protocol) - безопасность
- LCP (Link Control Protocol) - согласование на L2
- NCP (Network Control Protocol) - согласование на L3

Настройка соединения между точками
1. Установление L2 соединения. LCP:
    1. Один шлет свою конфигурацию (что будет использоваться) - Configure-Request
    2. Второй проверяет присланную конфигурацию и отвечает на него - Configure-Ack, затем шлет свой Configure-Request
    3. Если в Configure-Request:
       - Неправильные/неподдерживаемые параметры - Configure-Nak, затем другой присылает Configure-Request с другими параметрами
       - Непонятно, что это за параметр - Configure-Reject, затем другой отправляет конфигурацию без этих параметров
2. Аутентификация (Если была указана)
   - PAP
     1. Передача Username/Password в нешифрованном виде
     2. Ответ: Authenticate-Ack - успех, Authenticate-Nak - провал
   - CHAP
     1. Сервер отправляет пакет (Challenge) (ID, рандомное число)
     2. Клиент вычисляет MD5 хэш по формуле и отправляет результат (Response)
     3. Сервер отправляет результат проверки
3. Установление L3 соединения NCP
   - Выбор L3 протокола (Часто IPCP)
   - Согласование параметров конкретного протокола 
   
PPPoE, PPP over Ethernet:
- Инкапсуляция PPP пакетов в Ethernet
- L2

Установление сессии:
1. PPPoE Discovery
   1. Клиент шлет PPPoE Request - PADI (Broadcast)
   2. Свободные сервера отвечают - PADO (Unicast)
   3. Клиент выбирает сервер - PADR (Unicast)
   4. Сервер подтверждает клиента и создает сессию - PADS (Unicast)
2. PPPoE Session.
   1. Согласование PPP (как в обычном)
   2. Сама работа (передача данных)
3. PPPoE Terminating
   1. Клиент шлет пакет серверу - PADT (обрыв сессии как только получил пакет)
   
> PAD* - PPPoE Active Discovery
>> I - Initiation  
>> O - Offer  
>> R - Request  
>> S - Session-confirmation 
>> T - Termination

Вопросы:
1. During CHAP authentication, the password configured for a user is carried by PPP packets in plaintext.
- *false* - это в PAP  
2. Which of the following packet types is used by PPPoE to terminate a session?
- *PADT* - T = Termination  
3. If a packet with unmatched parameters is received during LCP negotiation, which of the following packet types is used by PPP to respond to the packet?
- *Configure-Nak* - Nak - для тех, что не поддерживаются, но понятно для чего они (например, версия не поддерживается), Reject - для тех, которые вообще не понятны (даже название параметра)
4. Which of the following authentication protocols are supported by PPP?
- *PAP*
- *CHAP*
5. Which of the following packet types are used during PPP negotiation?
- *LCP* - L2
- *PAP* - аутентификация
- *CHAP* - аутентификация
- *IPCP* - L3



###  Network Management and OM

###  IPv6 Basics

###  Introduction to SDN and NFV

###  Network Programmability and Automation

###  Typical Campus Network Architectures and Practices


-------
## Ответы на Final

### TRUE/FALSE

- During IP packet forwarding, … route ***(true)***
- Frames transmitted on the trunk link between … tagged ***(false)***
- WLAN technology enables transmission of information by radio waves … are used ***(false)***
- Switches can implement communication between homogeneous … broadcast domains ***(false)***
- Python can run in both interactive mode … mode ***(true)***
- A blackhole route (or null route) … loops ***(true)***
- SNMP is a standards-based network management protocol … protocol ***(false)***
- Segment routing (SR) provides … path ***(true)***
- To prevent out-of-order packets, it is recommended that … balancing ***(true)***
- After receiving a tagged frame … frame ***(false)***
- Software-defined networking (SDN) … interfaces ***(true)***
- AAA is short for … application ***(false)***
- The PVID of a trunk port … port ***(true)***
- Before sending an IPv6 packet, an interface … detection (DAD) ***(false)***
- In STP, a non-root-bridge … ports ***(false)***
- In the WLAN network architecture, ACs can … mode ***(true)***
- Specific routes can be … address ***(true)***
- FTP is a file transfer protocol … mode ***(true)***
- Network design and planning … construction ***(true)***
- In an OSPF AS, … ASBR ***(true)***
- A CAPWAP tunnel is … traffic ***(false)***
- The precision of telemetry-based … milliseconds ***(false)***
- Static routes and OSPF … routes ***(false)***
- When two static routes work as the primary … routes ***(true)***
- When a static route is configured … network ***(false)***
- As every two nodes in a full-mesh … costs ***(true)***
- The vlan batch 4 10 commands … VLAN 10 ***(true)***
- A hybrid port on a switch can connect to either a user … ***(true)***
- The Point-to-Point Protocol (PPP) is a common data link layer protocol … is false ***(The establishment … )***
- TFTP uses TCP to transfer files … number is 21 ***(false)***
- Segment routing (SR) can be deployed with or without controllers ***(true)***

### Single answer

 - The ping and tracert commands are used … false ***(The ping -s source-ip-address … packets)***
 - Which of the following statements … networking ***(Typically … deployment)***
 - The process for an AP to go … AC ***(Password authentication)***
 - When a ping command is run … device ***(ICMP)***
 - The Versatile Routing Platform … a device ***(pwd)***
 - Refer to the following ACL … satime ***(The ACL rule … days)***
 - Which is the most widely … method ***(Interface-based VLAN … )***
 - The MAC address table of a switch … frames ***(Floods the first frame and discards … frame)***
 - Which of the following statements about … true ***(A data tunnel and a control … AP)***
 - A WLAN is constructed using … false ***(A virtual access point ***(VAP)*** is a service … BSSID)***
 - Which of the following lists the correct … top ***(Physical layer, data link layer, network layer, transport layer, and application layer)***
 - Network address Translation (NAT) translates … of NAT ***(Implementing accurate … efficiency)***
 - Refer to the following AAA configuration … telnet ***(The authentication mode is local … )***
 - How many bytes does an MPLS label contain ***(4 bytes)***
 - Which of the following statements about STP and RSTP false ***(There are three RSTP port … Blocking)***
 - Which of the following statements about edge ports is false ***(It takes 15 seconds for an …)***
 - If the PVID a trunk port on a switch … is true ***(Data frames of VLANs 1, 7 and 9 can be … )***
 - Which of the following statements is false … Access Points ***(CAPWAP is an application … )***
 - Which of the following commands can be used … device ***(display ospf Isdb)***
 - The Domain Name System (DNS) protocol is used to resolve … is false ***(DNS supports traversal query)***
 - A router has the following four specific routes … be run ***(ip route-static 10.1.20.0 22 12.1.1.2)***
 - The Network Configuration Protocol ***(NETCONF)*** … is false ***( NETCONF … XML)***
 - The establishment of an OSPF … is true ***(The devices establish … LSDBs)***
 - Which of the following states indicates that … network ***(Two-way)***
 - Mastering the basic operations of the file system … files ***(A PAF … )***
 - An AC manages and controls APs in a centralized … AC ***(Multicast)***
 - NTP is a network protocol … false ***(NTP is a network … )***
 - The following shows the routing table of a specific router … used ***(OSPF route … )***
 - In the TCP/IP reference … protocol ***(PPP)***
 - OSPF has multiple types of protocol packets … routers ***(DD packet)***
 - OSPF authentication enables a device … is false ***(The authentication … )***
 - Refer to the following configuration … is true ***(The router allows a … Telnet)***
 - Various profiles are designed … is false ***(Only … )***
 - IPv6 addresses can be … type ***(Broadcast address)***
 - In STP, which of the following … priority ***(22528)***
 - Dynamic routing protocols … EGP ***(BGP)***
 - Which of the following port numbers is used by the Telnet protocol ***(23)***
 - Which of the following is not a method for an AP to discover an AC address ***(OSPF)***
 - What is the length range of a Ethernet frame ***(64 to 1518 bytes)***
 - As shown in the following networking, the … is true ***(The routing table of R1 contains only the OSPF …)***
 - Which of the following is not a valid port role in RSTP ***(Forwarding port)***
 - A WLAN is constructed using wireless .. is false ***(A virtual … )***
 - OSPF is configured on RTA, RTB … network ***(RTB functions as the DR, and RTC as the BDR)***
 - What is the valid VLAN ID range ***(1 to 4094)***
 - An IPv6 address is 128 bits long … ***(Each…)***
 - In which of the following modes are DHCP Discover messages sent ***(Broadcast)***
 - What is the network ID for the IP address 192.168.1.1/29 ***(192.168.1.0)***
 - The following shows partial OSPF … is false ***(The router is the slave…)***
 - It the same Ethernet network segment … is true ***(The neighbor status of a router on … 2 way)***
 - Refer to the following configuration  on a … command ***(VLANs 2 to 10 will be created)***
 - Which of the following statements about BPDUs in STP is false ***(When the network…)***
 - Network address Translation ***(NAT) translates the IP address in an IP packet header into another IP address … NAT ***(Implementing accurate …)***
 - In the same Ethernet network segment, five routers are running … is true? ***(The neighbor status of a router … )***
 - SNMP is used to manage network devices … is false? ***(The encryption…)***
 - Which in the most widely used VLAN assignment method ***(Interface-based VLAN … )***
 - Python can be used to implement automatic…is false? ***(Two forward slashes (//))***

### Multiple asnwers

An administrator wants to allocate … hosts ***(2 ответа)*** ***(172.16.4.35 255.255.255.258)*** ***(172.16.4.33 255.255.255.248)***
 - Which of the following are advantages of switch … clustering ***(3 ответа)*** ***(Simplifies network structure)*** ***(Improves network reliability)*** ***(Simplifies network management)***
 - A router can advertise … are false ***(2 ответа)*** ***(After … )*** ***(The preference … )***
 - Which of the following statements are false about the forwarding … a switch ***(2 ответа)*** ***(When an access … the port discards the frame)*** ***(When an access port of the switch sends … the port adds its default VLAN ID to the frame)***
 - Network Address Translation ***(NAT)*** … NAT ***(все варианты ответы)***
 - A WLAN is a network that uses wireless … a WLAN ***(все варианты ответа)***
 - The route preference is an indicator … routes ***(3 ответа)*** ***(Все кроме: The default preference of an OSPF … 255)***
 - In OSPF, which of the following … BDR ***(2 ответа)*** ***(NBMA)*** ***(BMA)***
 - PPP over Ethernet ***(PPPoE)*** … are true ***(все варианты ответа)***
 - Which of the following are IPv6 address types ***(Все кроме: Broadcast address)***
 - Which of the following are valid MAC address types? ***(Все кроме: Anycast MAC address)***
 - For the IPv6 address … rules ***(2 otveta)*** ***(2000:2A::A:20C:23D)*** ***(2000:2A:0:0:0A:20C:23D)***
 - The concept of Network Functions … architecture ***(Все кроме: OS)***
 - IPv6 have many advantages … are true ***(Все кроме: Uses gratuitous … )***
 - An IPv6 address is 128 bits … rules ***(Все кроме: 2001:DB8:0:1234:FB00::5:45FF)***
 - A host at 192.168.1.1/24 on an intranet.. are true ***(2 otveta)*** ***(The administrator … IP)*** ***(The address … gateway router)***
 - Which of the following statements about OSPF areas are true ***(Все варианты ответа)***
 - Which of the following are possible causes … online ***(Все варианты ответа)***
 - Refer to the following … are true ***(2 otveta)*** ***(This command enables a layer 3 … 3 link aggregation)*** ***(This command enables a router … 3 link aggregation)***
 - ACLs are used to match and … rules ***(Все варианты ответа)***
 - When troubleshooting a spanning …are true ***(2 otveta)*** ***(The administrator has changed the path … )*** ***( The switch uses … )***
 - Which of the following IP addresses are private IP addresses ***(3 otveta)*** ***(10.0.1.1/30)*** ***(192.168.1.1/30)*** ***(172.16.1.1/30)***
 - Which of the following are the advantages of a VLAN ***(Все варианты ответа)***
 - Which of the following statements about static and dynamic routes are true ***(Все кроме: When creating … )***
 - A WLAN is a constructed using wireless … scope ***(Все варианты ответа)***
 - Which of the following statements about collision domains and broadcast domains are true ***(Все варианты ответа)***
 - Which of the following parameters can be specified when an … ACL ***(Все кроме: Source and destination MAC addresses)***
 - In contrast with SNMPv1, … SNMPv2c ***(2 ответа)*** ***(Inform…)******(GetBulk…)***
 - The Domain Name System ***(DNS)*** protocol … domain name ***(Все варианты ответа)***
 - Refer to the following configuration on the … level 2 ***(Все кроме: The user can use the debugging…)***
 - Which of the following statements about layer 2 hybrid ports are true ***(3 otveta ***(When a tagged … frame)*** ***(When a tagged … link)*** ***(After receiving a tagged … frame)***
 - Network address Translation ***(NAT)*** translates the IP address in an IP packet … NAT ***(Все варианты ответа)***
 - Which of the following statements about IP addresses and MAC addresses are true ***(Все кроме: IP addresses are unchangeable)***
 - Which of the following statements about Layer 2 and  Layer 3 loops are true ***(Все кроме: The TTL field…)***
 - A WLAN is constructed  using wireless technologies … scope ***(Все варианты ответа)***
 - Which of the following statements about OSPF router IDs are true ***(3 otveta)*** ***(The router ID…)*** ***(To ensure …)*** ***(A router…)***
 - Refer to the following ACL configuration on a device … number 200 ***(2 otveta)*** ***(Packets with the source IP address 10.1.1.2 will be…)*** ***(Packets with the source IP address 10.1.1.3)***
 - As shown in the following networking, the interfaces connecting R1, R2, R3 … performed ***(2 otveta)*** ***(Run the … on GE0/0/1 of R1)*** ***(Run the … on GE0/0/3 R2)***
 - Which of the following are valid MAC address types?***(Всё, кроме Anycast MAC address)***
